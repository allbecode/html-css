Vamnos alterar novamente a modelagem da apresentação das manutenções. Decidi criar uma página para listar as manutenções realizadas, mas não haverá somente a lista das manutenções, nesta página o nome do carro será exibido no cabeçalho e logo abaixo o caminho percorrido pelo usuário para que o mesmo posso se localizar dentro do sistema. Haverá um menu lateral contendo as opções histórico, nova mautenção, lembretes, veículos, relatórios. Haverá também um card contendo um resumo dos custos com o veículo no último mês e no mês corrente.

Vamos começar com esta primeira página.


└───

=======================================================================


// Adicionar manutenção ao registro financeiro

        $ano = (int)date('Y', strtotime($dados['data']));
        $mes = (int)date('n', strtotime($dados['data']));
        $dataRegistro = date('Y-m-d');

        $dadosFinanceiros = [
            'usuario_id'        => $usuarioId,
            'nome'              => 'Manutenção do Carro',
            'data_vencimento'   => !empty($dados['data']) ? $dados['data'] : null,
            'valor'             => isset($dados['valor']) && $dados['valor'] !== '' ? (float)$dados['valor'] : null,
            'tipo'              => 'Despesa',
            'forma_pagamento'   => 'PIX',
            'descricao'         => !empty($dados['descricao']) ? $dados['descricao'] : null,
            'ano'               => $ano,
            'mes'               => $mes,
            'pago'              => isset($dados['pago']) ? 1 : 0,
            'data_registro'     => $dataRegistro,
            'base_contribuicao' => 0,
        ];

        $stmt = $pdo->prepare("
            INSERT INTO transacoes (
                usuario_id,
                nome, 
                data_vencimento, 
                valor, 
                tipo, 
                forma_pagamento, 
                descricao, 
                ano, 
                mes, 
                pago, 
                data_registro,
                base_contribuicao
            ) VALUES (
                :usuario_id,
                :nome, 
                :data_vencimento, 
                :valor, 
                :tipo, 
                :forma_pagamento, 
                :descricao, 
                :ano, 
                :mes, 
                :pago, 
                :data_registro,
                :base_contribuicao
            )
        ");
        $stmt->execute($dadosFinanceiros);


        DESCRIBE forma_pagamento;

        id	int(11)	NO	PRI	NULL	auto_increment	
        nome	varchar(100)	NO		NULL		


        
        DESCRIBE manutencoes_carro;

        id	int(11)	NO	PRI	NULL	auto_increment	
        carro_id	int(11)	NO	MUL	NULL		
        usuario_id	int(11)	NO	MUL	NULL		
        tipo_id	int(11)	NO		NULL		
        descricao	text	YES		NULL		
        data	date	NO		NULL		
        km	int(11)	YES		NULL		
        valor	decimal(10,2)	YES		NULL		
        local	varchar(100)	YES		NULL		
        pago	tinyint(1)	YES		0		
        proxima_manut_data	date	YES		NULL		
        proxima_manut_km	int(11)	YES		NULL		
        criado_em	timestamp	NO		current_timestamp()		
        transacao_id	int(11)	YES		NULL		
        forma_pagamento_id	int(11)	YES	MUL	NULL		


        
        Mostrando registros 0 -  2 (3 no total, Consulta levou 0.0003 segundos.)

        Mostrando registros 0 -  7 (8 no total, Consulta levou 0.0002 segundos.)

        SELECT id, forma_pagamento_id FROM manutencoes_carro;

        id	forma_pagamento_id	
        76	1	
        77	2	
        78	8	


        SELECT * FROM forma_pagamento;
        
        id	nome
        1	Boleto Bancário	
        2	Cartão de Crédito	
        3	Cheque	
        4	Crédito em Conta	
        5	Débito Automático	
        6	Débito em Conta	
        7	Espécie	
        8	PIX	



